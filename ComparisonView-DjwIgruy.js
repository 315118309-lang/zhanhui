import{a as c,b as d,c as y,p as R,t as k}from"./calcStore-CuhoDHwg.js";import{d as P,r as u,k as A,w as D,b as F,e as o,u as B,o as O,_ as S}from"./index-GOkqsi8G.js";const V={class:"view"},j={class:"actions"},z=["disabled"],I={class:"charts"},N=P({__name:"ComparisonView",setup(U){const p=u(null),f=u(null),v=u(null);let n=null,l=null,i=null,r=u(!1);const _=()=>{c.value||(c.value=y(R)),d.value||(d.value=y(k))},w=()=>{_();const t=c.value,e=d.value;if(p.value&&window.echarts&&(n=window.echarts.init(p.value),n.setOption({tooltip:{trigger:"axis"},legend:{data:["免冲洗","传统冲洗"]},xAxis:{type:"category",data:["材料","显影","能耗","人工"]},yAxis:{type:"value"},series:[{name:"免冲洗",type:"bar",data:[t.materialCost,t.developerCost,t.energyCost,t.laborCost]},{name:"传统冲洗",type:"bar",data:[e.materialCost,e.developerCost,e.energyCost,e.laborCost]}]})),f.value&&window.echarts){l=window.echarts.init(f.value);const a=[1,2,3,4,5],m=a.map(s=>t.totalCost*s),C=a.map(s=>e.totalCost*s);l.setOption({tooltip:{trigger:"axis"},legend:{data:["免冲洗累计","传统冲洗累计"]},xAxis:{type:"category",data:a.map(s=>`${s}年`)},yAxis:{type:"value"},series:[{name:"免冲洗累计",type:"line",data:m},{name:"传统冲洗累计",type:"line",data:C}]})}v.value&&window.echarts&&(i=window.echarts.init(v.value),i.setOption({tooltip:{trigger:"item"},legend:{orient:"horizontal"},series:[{name:"成本构成",type:"pie",radius:["40%","70%"],data:[{value:e.materialCost,name:"材料"},{value:e.developerCost,name:"显影"},{value:e.energyCost,name:"能耗"},{value:e.laborCost,name:"人工"}]}]}))};A(w),D([c,d],()=>{w()});const h=async()=>{r.value=!0;const{jsPDF:t}=window.jspdf||{};if(!t){r.value=!1;return}const e=new t({unit:"pt",format:"a4"});e.setFontSize(16),e.text("版材成本对比报告",40,40);const a=async(m,C,s,g,b)=>{const x=m.getDataURL({pixelRatio:2,backgroundColor:"#fff"});e.addImage(x,"PNG",C,s,g,b)};n&&await a(n,40,70,520,180),l&&await a(l,40,260,520,180),i&&await a(i,40,450,320,220),e.save("成本对比报告.pdf"),r.value=!1};return(t,e)=>(O(),F("section",V,[e[0]||(e[0]=o("h2",null,"成本对比",-1)),o("div",j,[o("button",{type:"button",onClick:h,disabled:B(r)},"导出PDF",8,z)]),o("div",I,[o("div",{ref_key:"barRef",ref:p,class:"chart"},null,512),o("div",{ref_key:"lineRef",ref:f,class:"chart"},null,512),o("div",{ref_key:"pieRef",ref:v,class:"chart"},null,512)])]))}}),L=S(N,[["__scopeId","data-v-7d0d10c4"]]);export{L as default};
